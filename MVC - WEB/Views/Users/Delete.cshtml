@model MVC_WEB.Models.ViewModels.UserDeleteViewModel
@{
    ViewData["Title"] = "Delete User";
}

<div class="page-header">
    <div class="d-flex justify-content-between align-items-center">
        <div>
            <h1><i class="fas fa-user-times text-danger"></i> Delete User</h1>
            <p class="mb-0">Permanently remove this user from the system</p>
        </div>
        <a asp-action="Index" class="btn btn-outline-secondary">
            <i class="fas fa-arrow-left"></i> Back to Users
        </a>
    </div>
</div>

<div class="row justify-content-center">
    <div class="col-lg-6">
        <div class="card shadow-sm border-danger">
            <div class="card-header bg-danger text-white">
                <h5 class="mb-0"><i class="fas fa-exclamation-triangle me-2"></i>Confirm Deletion</h5>
            </div>
            <div class="card-body text-center py-4">
                <div class="avatar-circle large mx-auto mb-3 bg-danger">
                    @(Model.User.FullName?.Split(' ').Select(n => n.FirstOrDefault()).Take(2).Aggregate("", (acc, c) => acc + c))
                </div>
                
                <h4 class="mb-1">@Model.User.FullName</h4>
                <p class="text-muted mb-2">
                    <i class="fas fa-envelope me-1"></i>@Model.User.Email
                </p>
                @{
                    var roleColor = Model.User.Role switch
                    {
                        "Admin" => "danger",
                        "Manager" => "warning",
                        "Pharmacist" => "success",
                        "Staff" => "info",
                        "User" => "primary",
                        _ => "secondary"
                    };
                }
                <span class="badge bg-@roleColor mb-4">@Model.User.Role</span>

                <div class="alert alert-warning">
                    <i class="fas fa-exclamation-circle me-2"></i>
                    <strong>Warning:</strong> This action cannot be undone. All data associated with this user will be permanently deleted.
                </div>

                @if (Model.User.Role == "Admin")
                {
                    <div class="alert alert-danger">
                        <i class="fas fa-shield-alt me-2"></i>
                        <strong>Caution:</strong> You are about to delete an administrator account. Ensure there is at least one other admin user in the system.
                    </div>
                }

                <p class="text-muted">
                    Are you sure you want to delete the user <strong>@Model.User.FullName</strong>?
                </p>

                <form asp-action="Delete" method="post" class="mt-4">
                    <input type="hidden" name="id" value="@Model.User.UserID" />
                    <div class="d-flex gap-2 justify-content-center">
                        <button type="submit" class="btn btn-danger">
                            <i class="fas fa-trash me-1"></i> Yes, Delete User
                        </button>
                        <a asp-action="Index" class="btn btn-secondary">
                            <i class="fas fa-times me-1"></i> Cancel
                        </a>
                    </div>
                </form>
            </div>
        </div>

        <!-- User Details Summary -->
        <div class="card shadow-sm mt-4">
            <div class="card-header bg-secondary text-white">
                <h6 class="mb-0"><i class="fas fa-info-circle me-2"></i>User Details</h6>
            </div>
            <div class="card-body">
                <table class="table table-sm table-borderless mb-0">
                    <tr>
                        <td class="text-muted" width="40%">User ID:</td>
                        <td><code>@Model.User.UserID</code></td>
                    </tr>
                    <tr>
                        <td class="text-muted">Full Name:</td>
                        <td>@Model.User.FullName</td>
                    </tr>
                    <tr>
                        <td class="text-muted">Email:</td>
                        <td>@Model.User.Email</td>
                    </tr>
                    <tr>
                        <td class="text-muted">Role:</td>
                        <td><span class="badge bg-@roleColor">@Model.User.Role</span></td>
                    </tr>
                    <tr>
                        <td class="text-muted">Last Login:</td>
                        <td>
                            @if (Model.User.LastLoginDate != default)
                            {
                                @Model.User.LastLoginDate.ToString("MMM dd, yyyy")
                            }
                            else
                            {
                                <span class="text-muted">Never</span>
                            }
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
</div>

@section Styles {
    <style>
        .avatar-circle.large {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(45deg, #dc3545, #c82333);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 28px;
        }

        .avatar-circle.large.bg-danger {
            background: linear-gradient(45deg, #dc3545, #c82333) !important;
        }
    </style>
}
